function zoomImg(t){if(!isEmpty(t.id)&&!isEmpty(t.src)){var e=t.id,i=t.src,o=$("#"+e),a=o.attr("isClick"),s=document.createElement("img");s.src=i,$(s).load(function(){var t=width=s.offsetWidth||s.width,e=height=s.offsetHeight||s.height;o.show();var n=o.find(".layui-layer-content").width(),c={};width/height>1?(t=n,e=n*height/width,c["padding-top"]=(t-e)/2+"px"):(e=n,t=n*width/height,c["padding-left"],(e-t)/2+"px"),c.width=t,c.height=e,o.find("img").css(c),o.find("img")[0].src=i,isEmpty(a)&&o.click(function(){$(this).hide()})})}}var query=urlParse();!function(){function t(){var t=$(this),i=$("#"+t.attr("phoneId")),o=i.val();if(!isPhone(o))return void alert("请输入正确的手机号！");var a={userPhone:o||"",activityId:query.activityId||""};$.ajax({type:"POST",url:"/router/dealer/share_dealer_trading",data:JSON.stringify(a),contentType:"application/json",dataType:"json",success:function(t){"undefined"==typeof t.err&&"undefined"!=typeof t.status&&(e(t),i.val("输入手机号领取优惠券"))}})}function e(t){var e=0;isEmpty(t.data)||isEmpty(t.data.limitNum)||(e=t.data.limitNum);var o={0:{msg:'券已领取成功，可在"我的优惠券"中进行查看！',cls:"clink-getIt",addInfo:!0},1:{msg:"该链接已失效",cls:"tipscouface"},2:{msg:'对不起，您还不是丹露终端店注册用户，请先注册！<a href="http://www.danlu.com/registerNew/terminal-step1.html">前往注册</a>',cls:"tipscouface"},3:{msg:"对不起，该优惠券仅限终端店用领取，请您关注丹露其它促销活动！",cls:"tipscouface"},4:{msg:"对不起，由于你所在的区域不在本次发放区域内，您无法领取该优惠券！",cls:"tipscouface"},5:{msg:"对不起，由于售卖权不匹配，您无法领取该优惠券！",cls:"tipscouface"},6:{msg:"您的账号还在审批中，请审批通过后再进行领取!",cls:"tipscouface"},7:{msg:"对不起，该券一人只能领"+e+"次，您已领取"+e+"次，无法再次领取！",cls:"clink-geted",addInfo:!0},8:{msg:"您已领取该券，请使用后再进行领取！",cls:"clink-geted",addInfo:!0},9:{msg:"对不起，您来晚了，券已被领完，下次加油！",cls:"clink-getedAll",addInfo:!0},10:{msg:"对不起，由于您的终端店类型不匹配本券的发放限制，您无法领取该优惠券！",cls:"tipscouface"}},a=t.data;if($(".cgetInfos").html(o[t.status].msg),i("#mfaceInfos,#pcCopFace",o[t.status].cls),!isEmpty(o[t.status].addInfo)&&1==o[t.status].addInfo){$(".coupon-info .cop-list-left .packets-money").html(a.couponMinAmt/100),$(".coupon-info .cop-list-left .packets-info").html("满"+a.effectiveAmt/100+"可以使用");var n=$(".coupon-info .cop-list-right"),c=a.dealerCouponDto.availableChannel,l=[];if(isEmpty(c))l.push("全部");else for(var d=c.split(","),r=0,m=d.length;m>r;r++)isEmpty(d[r])||l.push(s[trim(d[r])]);n.find(".platform_limit").html((isEmpty(a.dealerCouponDto.platformLimit)?"WEB;APP":a.dealerCouponDto.platformLimit)+"可用"),n.find(".effectiveTime").html(getDate(a.effectiveTime)+"-"+getDate(a.uneffectiveTime)),n.find(".dealer_name").html(a.dealerCouponDto.dealerName),n.find(".goods_name").html("【"+l.join(",")+"】"+a.dealerCouponDto.goodsName),n.find(".goods_name").attr("title","【"+l.join(",")+"】"+a.dealerCouponDto.goodsName);var f=n.find(".goods-icon img");f[0].src=isEmpty(a.dealerCouponDto.dealerCouponImgUrl)?STATIC_PRE+"/resource/images/businesscoupon/default.jpg":a.dealerCouponDto.dealerCouponImgUrl,f.click(function(){zoomImg({src:f[0].src,id:"pic-layer-content"})})}1==t.status&&($(".main,.Mmain").hide(),$(".invalidLinked").show())}function i(t,e){$(t).removeClass("clink-geted clink-getIt tipscouface clink-getedAll couface").addClass(e)}function o(){var t=$(this);""==$.trim(t.val())&&t.val("输入手机号领取优惠券")}function a(){var t=$(this),e=$.trim(t.val());"输入手机号领取优惠券"==e&&t.val(""),isNumber(e)||t.val("")}var s={S011:"烟酒专卖店",S012:"便利店",S013:"餐饮店",S014:"商业超市",S015:"其它"};$(".telInpu").focus(a).blur(o),$(".getActivity").click(t)}();