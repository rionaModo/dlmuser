!function(e){e.fn.scrollbox=function(t){function i(){return navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)?!0:!1}var n={linear:!1,startDelay:2,delay:3,step:5,speed:32,switchItems:1,direction:"vertical",distance:"auto",autoPlay:!0,onMouseOverPause:!0,onTouchPause:!0,paused:!1,queue:null,listElement:"ul",listItemElement:"li",infiniteLoop:!0,switchAmount:0,afterForward:null,afterBackward:null,triggerStackable:!1};return t=e.extend(n,t),t.scrollOffset="vertical"===t.direction?"scrollTop":"scrollLeft",t.queue&&(t.queue=e("#"+t.queue)),this.each(function(){var n,l,r,o,a,s,c,u,d,f=e(this),h=null,m=null,p=!1,I=0,v=0;t.onMouseOverPause&&!i()&&(f.bind("mouseover",function(){p=!0}),f.bind("mouseout",function(){p=!1})),t.onTouchPause&&i()&&(f.bind("touchstart",function(){p=!0}),f.bind("touchend",function(){p=!1})),n=f.children(t.listElement+":first-child"),t.infiniteLoop===!1&&0===t.switchAmount&&(t.switchAmount=n.children().length),s=function(){if(!p){var i,r,a,s,c;if(i=n.children(t.listItemElement+":first-child"),s="auto"!==t.distance?t.distance:"vertical"===t.direction?i.outerHeight(!0):i.outerWidth(!0),t.linear?a=Math.min(f[0][t.scrollOffset]+t.step,s):(c=Math.max(3,parseInt(.3*(s-f[0][t.scrollOffset]),10)),a=Math.min(f[0][t.scrollOffset]+c,s)),f[0][t.scrollOffset]=a,a>=s){for(r=0;r<t.switchItems;r++)t.queue&&t.queue.find(t.listItemElement).length>0?(n.append(t.queue.find(t.listItemElement)[0]),n.children(t.listItemElement+":first-child").remove()):n.append(n.children(t.listItemElement+":first-child")),++I;if(f[0][t.scrollOffset]=0,clearInterval(h),h=null,e.isFunction(t.afterForward)&&t.afterForward.call(f,{switchCount:I,currentFirstChild:n.children(t.listItemElement+":first-child")}),t.triggerStackable&&0!==v)return void l();if(t.infiniteLoop===!1&&I>=t.switchAmount)return;t.autoPlay&&(m=setTimeout(o,1e3*t.delay))}}},c=function(){if(!p){var i,r,a,s,c;if(0===f[0][t.scrollOffset]){for(r=0;r<t.switchItems;r++)n.children(t.listItemElement+":last-child").insertBefore(n.children(t.listItemElement+":first-child"));i=n.children(t.listItemElement+":first-child"),s="auto"!==t.distance?t.distance:"vertical"===t.direction?i.height():i.width(),f[0][t.scrollOffset]=s}if(t.linear?a=Math.max(f[0][t.scrollOffset]-t.step,0):(c=Math.max(3,parseInt(.3*f[0][t.scrollOffset],10)),a=Math.max(f[0][t.scrollOffset]-c,0)),f[0][t.scrollOffset]=a,0===a){if(--I,clearInterval(h),h=null,e.isFunction(t.afterBackward)&&t.afterBackward.call(f,{switchCount:I,currentFirstChild:n.children(t.listItemElement+":first-child")}),t.triggerStackable&&0!==v)return void l();t.autoPlay&&(m=setTimeout(o,1e3*t.delay))}}},l=function(){0!==v&&(v>0?(v--,m=setTimeout(o,0)):(v++,m=setTimeout(r,0)))},o=function(){clearInterval(h),h=setInterval(s,t.speed)},r=function(){clearInterval(h),h=setInterval(c,t.speed)},u=function(){t.autoPlay=!0,p=!1,clearInterval(h),h=setInterval(s,t.speed)},d=function(){p=!0},a=function(e){t.delay=e||t.delay,clearTimeout(m),t.autoPlay&&(m=setTimeout(o,1e3*t.delay))},t.autoPlay&&(m=setTimeout(o,1e3*t.startDelay)),f.bind("resetClock",function(e){a(e)}),f.bind("forward",function(){t.triggerStackable?null!==h?v++:o():(clearTimeout(m),o())}),f.bind("backward",function(){t.triggerStackable?null!==h?v--:r():(clearTimeout(m),r())}),f.bind("pauseHover",function(){d()}),f.bind("forwardHover",function(){u()}),f.bind("speedUp",function(e,i){"undefined"===i&&(i=Math.max(1,parseInt(t.speed/2,10))),t.speed=i}),f.bind("speedDown",function(e,i){"undefined"===i&&(i=2*t.speed),t.speed=i}),f.bind("updateConfig",function(i,n){t=e.extend(t,n)})})}}(jQuery);